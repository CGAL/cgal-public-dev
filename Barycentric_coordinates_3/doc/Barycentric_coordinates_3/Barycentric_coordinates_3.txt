namespace CGAL {
namespace Barycentric_coordinates {

/*!
\mainpage User Manual
\anchor Chapter_3D_Generalized_Barycentric_Coordinates
\cgalAutoToc

\authors Antonio Gomes, Dmitry Anisimov


\section gbc_3_introduction Introduction

Barycentric coordinates are an important tool in computer graphics and geometric modeling. 
Originally, these coordinates were used to represent a given point with respect to a simplex but have been later
 generalized to more complex shapes.

The package 3D Generalized Barycentric Coordinates offers an efficient and robust implementation 
of three-dimensional closed-form generalized barycentric coordinates defined for convex simplicial polytopes.

In particular, this package includes an implementation of Wachspress, discrete harmonic, mean value, and
 one extra function to calculate barycentric coordinates with respect to tetrahedrons.


\section gbc_3_interface Software Design

Wachspress, discrete harmonic, and mean value coordinates are all generalized barycentric coordinates 
that can be computed analytically. In this implementation, we restrict our polyhedra to convex ones 
with triangular faces, although some of the coordinates may accept more general shapes. 

All of the three barycentric coordinates can be computed either by instantiating a class or through a 
free function. Tetrahedron coordinates can be computed only through the free function. 

We can specify a computation policy Barycentric_coordinates::Computation_policy_3 that can be FAST or 
FAST_WITH_EDGE_CASES for each of the three coordinates. The difference between them is that FAST_WITH_EDGE_CASES
 treats points near the boundaries by projecting them into the face of the polyhedron and then calculating triangle coordinates.

The output of a query point is the coordinate value with respect to each vertex, the number of coordinate
 values is the same as the number of vertices, and the ordering is also the same.

All class and function templates are parameterized by a traits class, which is a model of the concept 
BarycentricTraits_3. It provides all necessary geometric primitives, predicates, and constructions, 
which are required for the computation. All models of Kernel can be used. A polyhedron is provided as 
a model of the concept FaceListGraph with a property map that maps a vertex from the polyhedron to CGAL::Point_3.


\section gbc_3_examples Examples

In order to facilitate the process of learning this package, we provide various examples
with a basic usage of different barycentric components.


\subsection tetra_example Tetrahedron Coordinates

In this example, we use the global function tetrahedron_coordinates_in_tuple(). 
We compute coordinates for the tetrahedron whose vertices are the points in the 
set {(0,0,0), (1,0,0), (0,1,0), (0,0,1)}. Were used points inside, outside and 
at the boundary of the tetrahedron.
\anchor tetra_coord_example
\cgalExample{Barycentric_coordinates_3/tetrahedron_coordinates.cpp}

\subsection wp_3_example Wachspress Coordinates

In this example, we generate 250 random points inside a unitary sphere, 
centered at the origin, then we take the convex hull of this set of points 
and use this as our polyhedron. Finally, we calculate Wachspress coordinates 
for all of these 250 points.
\anchor wp_3_coord_example
\cgalExample{Barycentric_coordinates_3/wachspress_coordinates.cpp}

\subsection dh_3_example Discrete Harmonic Coordinates

This example is very similar to the one used with tetrahedron coordinates. 
We started with a regular icosahedron and for points inside, outside and 
at the boundary, we calculate discrete harmonic coordinates. In this example, 
we use the fast with edge cases algorithm because it treats points very close 
to the boundaries.
\anchor dh_3_coord_example
\cgalExample{Barycentric_coordinates_3/discrete_harmonic_coordinates.cpp}

\subsection mv_3_example Mean Value Coordinates

This example shows how to compute mean value coordinates for a set of points in a 
star-shaped polyhedron. We note that this type of coordinate is well-defined for a 
concave polyhedron and it may yield negative coordinate values for points outside 
the polyhedron's kernel. 
\anchor mv_3_coord_example
\cgalExample{Barycentric_coordinates_3/mean_value_coordinates.cpp}

\subsection shape_deform_example Shape deformation

This is an example that shows how to deform a simple smooth sphere into 
another shape, topologically equivalent. To achieve this, we enclose the 
sphere inside a cube cage, then we calculate the barycentric 
coordinate of each vertex with respect to the cube cage. After deforming 
the cage, we calculate the linear combination of the points to get the 
deformed sphere vertices.
\anchor shape_deform_example_3
\cgalExample{Barycentric_coordinates_3/shape_deformation.cpp}

\section gbc_3_degeneracies Edge Cases

The precision of each coordinate depends on the used `Kernel`. If an inexact kernel 
is used and the user is not sure if the points are near the boundaries, `FAST_WITH_EDGE_CASES` 
algorithm should be used.
Implementation details are describe in \cgalCite{cgal:bc:f-wmvc-14} for Wachspress and mean value 
coordinates, and in \cgalCite{cgal:bc:jlw-ggcccsp-07} for discrete harmonic coordinates.

\section gbc_3_performance Performance

Here are the results of the benchmark done for each coordinate. A total of 1000000 
points were sampled regularly inside each shape.

<table class="markdownTable" align="center">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Coordinate type </th>
<th class="markdownTableHeadCenter">Shape </th>
<th class="markdownTableHeadCenter">Total time (in seconds)</th>
</tr>
<tr class="markdownTableBody">
<td class="markdownTableBodyCenter">Wachspress</td>
<td class="markdownTableBodyCenter">Triangulated cube</td>
<td class="markdownTableBodyCenter">59.1783669</td>
</tr>
<tr class="markdownTableBody">
<td class="markdownTableBodyCenter">Discrete Harmonic</td>
<td class="markdownTableBodyCenter">Triangulated cube</td>
<td class="markdownTableBodyCenter">167.832063</td>
</tr>
<tr class="markdownTableBody">
<td class="markdownTableBodyCenter">Mean Value</td>
<td class="markdownTableBodyCenter">Triangulated cube</td>
<td class="markdownTableBodyCenter">199.651994</td>
</tr>
<tr class="markdownTableBody">
<td class="markdownTableBodyCenter">Tetrahedron</td>
<td class="markdownTableBodyCenter">Tetrahedron</td>
<td class="markdownTableBodyCenter">1.612018108</td>
</tr>
</table>


\section gbc_3_history History

This package was introduced during GSoC 2021 and implemented by Antonio Gomes 
under the supervision of Dmitry Anisimov.

\section gbc_3_acknowledgments Acknowledgments


*/

} /* namespace Barycentric_coordinates */
} /* namespace CGAL */
